use super::RgbColor;

/// Converts the given RGB color to the closest palette color from a 128 color palette
///
/// Stolen from https://www.reddit.com/r/Novation/comments/vgitm0/reverse_engineering_launchpad_pro_color_to/.
///
/// This palette applies for the Mk2, Mk3 and Mk3 Mini.
pub fn rgb_to_palette(color: RgbColor) -> u8 {
    let r = color.r >> 5;
    let g = color.g >> 5;
    let b = color.b >> 5;
    let i = 64 * r as usize + 8 * g as usize + b as usize;
    COLORS[i]
}

static COLORS: [u8; 512] = [
    0, 47, 51, 46, 46, 69, 69, 45, 23, 39, 51, 42, 50, 69, 69, 45, 64, 123, 102, 38, 66, 69, 69,
    79, 22, 30, 34, 68, 66, 66, 41, 41, 76, 76, 34, 66, 66, 66, 41, 41, 76, 122, 122, 122, 77, 33,
    37, 37, 122, 122, 122, 29, 77, 33, 90, 37, 21, 21, 21, 29, 77, 33, 90, 90, 7, 55, 51, 50, 50,
    69, 69, 80, 15, 1, 112, 50, 50, 69, 69, 80, 19, 71, 112, 104, 66, 92, 92, 80, 18, 18, 34, 68,
    66, 92, 92, 41, 18, 76, 76, 66, 66, 92, 92, 40, 76, 122, 122, 24, 28, 32, 36, 36, 122, 122,
    122, 24, 28, 32, 32, 36, 21, 21, 21, 24, 28, 32, 32, 90, 121, 59, 112, 54, 54, 50, 80, 80, 83,
    71, 112, 54, 54, 69, 80, 80, 125, 125, 117, 117, 117, 92, 80, 80, 63, 63, 117, 117, 118, 92,
    44, 44, 63, 63, 63, 118, 118, 92, 40, 40, 111, 111, 111, 24, 28, 32, 40, 36, 17, 17, 20, 24,
    28, 32, 36, 36, 17, 17, 20, 24, 28, 32, 32, 36, 6, 58, 58, 54, 54, 54, 49, 49, 10, 58, 54, 54,
    54, 49, 49, 49, 10, 105, 117, 117, 54, 49, 49, 49, 14, 14, 117, 118, 118, 118, 44, 44, 14, 14,
    111, 118, 118, 2, 91, 91, 111, 111, 111, 118, 2, 2, 91, 91, 111, 111, 75, 89, 89, 114, 114, 36,
    75, 75, 75, 89, 89, 114, 114, 114, 6, 58, 58, 54, 54, 82, 81, 81, 10, 58, 54, 54, 82, 82, 81,
    81, 61, 105, 105, 54, 82, 82, 81, 81, 62, 99, 99, 118, 118, 2, 48, 48, 99, 99, 99, 118, 2, 2,
    93, 93, 111, 111, 111, 2, 2, 2, 93, 115, 85, 85, 85, 16, 114, 114, 114, 115, 98, 98, 16, 16,
    114, 114, 114, 114, 120, 120, 106, 82, 82, 82, 94, 94, 120, 106, 106, 82, 82, 82, 94, 94, 61,
    61, 61, 82, 82, 82, 94, 94, 126, 126, 126, 118, 2, 2, 116, 116, 126, 126, 97, 2, 2, 2, 93, 116,
    97, 97, 97, 2, 2, 2, 115, 115, 110, 110, 110, 16, 113, 114, 114, 115, 74, 74, 73, 16, 113, 114,
    114, 119, 106, 106, 57, 57, 82, 82, 94, 94, 106, 106, 57, 95, 82, 82, 94, 94, 60, 84, 107, 82,
    82, 82, 94, 94, 126, 108, 107, 107, 56, 56, 52, 52, 108, 108, 107, 107, 56, 56, 52, 52, 97, 97,
    97, 8, 8, 8, 115, 115, 97, 97, 73, 113, 113, 8, 119, 119, 73, 73, 73, 113, 113, 113, 119, 119,
    5, 5, 57, 57, 95, 95, 53, 53, 5, 5, 57, 95, 95, 95, 53, 53, 60, 84, 4, 95, 56, 56, 53, 53, 84,
    9, 4, 4, 56, 56, 52, 52, 96, 96, 96, 4, 56, 56, 52, 52, 96, 96, 109, 8, 8, 8, 52, 52, 109, 109,
    109, 8, 8, 8, 3, 3, 13, 13, 12, 113, 113, 113, 3, 3,
];
